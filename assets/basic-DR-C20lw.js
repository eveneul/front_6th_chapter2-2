import{j as e,r as x,R as Y,a as Z}from"./client-DvaAtPIX.js";function C({children:t,type:s="button",variant:a="default",className:r="",onClick:n,icon:i}){const c="p-0 w-auto h-auto transition-colors",o={default:"text-gray-400 hover:text-gray-500",danger:"text-gray-400 hover:text-red-500",toast:"text-white hover:text-gray-200",error:"text-red-600 hover:text-red-800"};return e.jsx("button",{type:s,onClick:n,className:`${c} ${o[a]} ${r}`,children:i||t})}const P=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),F=()=>e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),T=({className:t,strokeWidth:s})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:s,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),ee=()=>e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),te=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),se=()=>e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})});function re({type:t,message:s,onClose:a}){const r="p-4 rounded-md shadow-md text-white flex justify-between items-center",n={success:"bg-green-600",warning:"bg-yellow-600",error:"bg-red-600"};return e.jsxs("div",{className:`${r} ${n[t]}`,children:[e.jsx("span",{className:"mr-2",children:s}),e.jsx(C,{variant:"toast",onClick:a,icon:e.jsx(P,{})})]})}function y({children:t,type:s="button",variant:a="primary",size:r="md",className:n,onClick:i,disabled:c}){const l={primary:`bg-gray-900 text-white transition-colors hover:bg-gray-800 ${c&&"!bg-gray-100 !text-gray-400 cursor-not-allowed"}`,ghost:"px-3 py-1.5 text-sm rounded transition-colors text-gray-600 hover:text-gray-900",link:"text-blue-600 no-underline !p-0",outline:"border border-gray-300 font-medium text-gray-700 hover:bg-gray-50"},h={xs:"w-6 h-6 rounded flex items-center justify-center hover:bg-gray-100",sm:"rounded px-3 py-1.5 text-sm",md:"rounded-md px-4 py-2 text-sm",lg:"py-2 px-4 rounded-md font-medium"};return e.jsx("button",{onClick:i,type:s,className:` ${l[a]} ${h[r]} ${n}`,children:t})}function ae({isAdmin:t,setIsAdmin:s,query:a,setQuery:r,cart:n,totalCartItem:i}){return e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!t&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:a,onChange:c=>r(c.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx(y,{variant:t?"primary":"ghost",size:"sm",onClick:()=>s(!t),children:t?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!t&&e.jsxs("div",{className:"relative",children:[e.jsx(F,{}),n.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:i})]})]})]})})})}const q=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],ne=()=>{const[t,s]=x.useState(()=>{const i=localStorage.getItem("products");if(i)try{return JSON.parse(i)}catch{return q}return q}),a=x.useCallback(i=>{const c={...i,id:`p${Date.now()}`};s(o=>[...o,c])},[]),r=x.useCallback((i,c)=>{s(o=>o.map(l=>l.id===i?{...l,...c}:l))},[]),n=x.useCallback(i=>{s(c=>c.filter(o=>o.id!==i))},[]);return x.useEffect(()=>{localStorage.setItem("products",JSON.stringify(t))},[t]),{products:t,setProducts:s,addProduct:a,updateProduct:r,deleteProduct:n}},ie=()=>{const[t,s]=x.useState([]),a=x.useCallback((n,i="success")=>{const c=Date.now().toString();s(o=>[...o,{id:c,message:n,type:i}]),setTimeout(()=>{s(o=>o.filter(l=>l.id!==c))},3e3)},[]),r=x.useCallback(n=>{s(i=>i.filter(c=>c.id!==n.id))},[]);return{notifications:t,removeNotificationAtom:r,addNotification:a}},ce=(t,s)=>{const[a,r]=x.useState({name:"",price:0,stock:0,description:"",discounts:[]}),[n,i]=x.useState(null);return{productForm:a,setProductForm:r,handleProductSubmit:(l,h)=>{l.preventDefault(),n&&n!=="new"?s(n,a):t({...a,discounts:a.discounts}),r({name:"",price:0,stock:0,description:"",discounts:[]}),i(null),h?.()},editingProduct:n,setEditingProduct:i,handleProductEdit:l=>{i(l.id),r({name:l.name,price:l.price,stock:l.stock,description:l.description||"",discounts:l.discounts||[]})}}},L=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],M=(t,s=null)=>{let a=0,r=0;return t.forEach(n=>{if(!n.product||typeof n.product.price!="number"){console.warn("Invalid cart item:",n);return}const i=n.product.price*n.quantity;a+=i,r+=$(n,t)}),s&&(s.discountType==="amount"?r=Math.max(0,r-s.discountValue):r=Math.round(r*(1-s.discountValue/100))),{totalBeforeDiscount:Math.round(a),totalAfterDiscount:Math.round(r)}},$=(t,s)=>{if(!t.product||typeof t.product.price!="number")return console.warn("Invalid cart item in calculateItemTotal:",t),0;const{price:a}=t.product,{quantity:r}=t,n=le(t,s);return Math.round(a*r*(1-n))},le=(t,s)=>{if(!t.product||!t.product.discounts)return 0;const{discounts:a}=t.product,{quantity:r}=t,n=a.reduce((c,o)=>r>=o.quantity&&o.rate>c?o.rate:c,0);return s.some(c=>c.quantity>=10)?Math.min(n+.05,.5):n},oe=(t,s)=>{const[a,r]=x.useState(()=>{const o=localStorage.getItem("coupons");if(o)try{return JSON.parse(o)}catch{return L}return L}),[n,i]=x.useState(null),c=x.useCallback((o,l)=>{if(M(l,n).totalAfterDiscount<1e4&&o.discountType==="percentage"){s?.("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.");return}i(o),t?.("쿠폰이 적용되었습니다.")},[t,s]);return x.useEffect(()=>{localStorage.setItem("coupons",JSON.stringify(a))},[a]),{coupons:a,setCoupons:r,selectedCoupon:n,setSelectedCoupon:i,applyCoupon:c}},de=(t,s,a=null,r,n,i,c)=>{const[o,l]=x.useState({name:"",code:"",discountType:"amount",discountValue:0}),h=x.useCallback((u,m)=>{if(m.find(p=>p.code===u.code)){i?.("이미 존재하는 쿠폰 코드입니다.");return}s(p=>[...p,u]),n?.("쿠폰이 추가되었습니다.")},[t,n,i]),d=x.useCallback(u=>{s(m=>m.filter(f=>f.code!==u)),a?.code===u&&r(null),c?.("쿠폰이 삭제되었습니다.")},[a,c]);return{couponForm:o,setCouponForm:l,deleteCoupon:d,handleCouponSubmit:(u,m)=>{u.preventDefault(),h(o,t),l({name:"",code:"",discountType:"amount",discountValue:0}),m?.()}}},N=(t,s)=>{const a=s.find(n=>n.product.id===t.id);return t.stock-(a?.quantity||0)},ue=(t,s,a)=>{const[r,n]=x.useState(()=>{const d=localStorage.getItem("cart");if(d)try{const g=JSON.parse(d);return Array.isArray(g)?g.filter(u=>u&&u.product&&typeof u.product.id=="string"&&typeof u.product.price=="number"&&typeof u.quantity=="number"):[]}catch{return[]}return[]}),[i,c]=x.useState(0);x.useEffect(()=>{const d=r.reduce((g,u)=>g+u.quantity,0);c(d)},[r]),x.useEffect(()=>{r.length>0?localStorage.setItem("cart",JSON.stringify(r)):localStorage.removeItem("cart")},[r]);const o=x.useCallback(d=>{if(N(d,r)<=0){a?.("재고가 부족합니다!");return}n(u=>{const m=u.find(f=>f.product.id===d.id);if(m){const f=m.quantity+1;return f>d.stock?(a(`재고는 ${d.stock}개까지만 있습니다.`),u):u.map(p=>p.product.id===d.id?{...p,quantity:f}:p)}return[...u,{product:d,quantity:1}]}),s?.("장바구니에 담았습니다")},[r,s,a,N]),l=x.useCallback(d=>{n(g=>g.filter(u=>u.product.id!==d))},[]),h=x.useCallback((d,g)=>{if(g<=0){l(d);return}const u=t.find(f=>f.id===d);if(!u)return;const m=u.stock;if(g>m){a(`재고는 ${m}개까지만 있습니다.`);return}n(f=>f.map(p=>p.product.id===d?{...p,quantity:g}:p))},[t,l,a,N]);return{cart:r,setCart:n,totalCartItem:i,setTotalCartItem:c,addToCart:o,removeFromCart:l,updateQuantity:h}};function xe(t,s,a){return{completeOrder:x.useCallback(()=>{const n=`ORD-${Date.now()}`;a?.(`주문이 완료되었습니다. 주문번호: ${n}`),t(),s()},[a])}}const me=(t,s)=>s?t.filter(a=>a.name.toLowerCase().includes(s.toLowerCase())||a.description?.toLowerCase().includes(s.toLowerCase())):t,he=()=>{const[t,s]=x.useState(""),[a,r]=x.useState("");return x.useEffect(()=>{const n=setTimeout(()=>{r(t)},500);return()=>clearTimeout(n)},[t]),{query:t,setQuery:s,debouncedQuery:a}},B=(t,s,a)=>a?"SOLD OUT":ge(t,s),ge=(t,s)=>s?`${t.toLocaleString()}원`:`₩${t.toLocaleString()}`;function b({type:t="text",className:s="",size:a="md",...r}){const n={xs:"w-16 px-2 py-1 rounded",sm:"w-20 px-2 py-1 rounded",md:"w-full px-3 py-2 rounded-md shadow-sm",lg:""};return e.jsx("input",{type:t,className:`border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 border ${n[a]} ${s}`,...r})}function pe({editingProduct:t,productForm:s,handleProductSubmit:a,onFormChange:r,onNotify:n,onToggleForm:i,onEditClick:c}){return e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:o=>{a(o,()=>i(!1))},className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx(b,{type:"text",value:s.name,onChange:o=>r({...s,name:o.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx(b,{type:"text",value:s.description,onChange:o=>r({...s,description:o.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx(b,{type:"text",value:s.price===0?"":s.price,onChange:o=>{const l=o.target.value;(l===""||/^\d+$/.test(l))&&r({...s,price:l===""?0:parseInt(l)})},onBlur:o=>{const l=o.target.value;l===""?r({...s,price:0}):parseInt(l)<0&&(n("가격은 0보다 커야 합니다","error"),r({...s,price:0}))},placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx(b,{type:"text",value:s.stock===0?"":s.stock,onChange:o=>{const l=o.target.value;(l===""||/^\d+$/.test(l))&&r({...s,stock:l===""?0:parseInt(l)})},onBlur:o=>{const l=o.target.value;l===""?r({...s,stock:0}):parseInt(l)<0?(n("재고는 0보다 커야 합니다","error"),r({...s,stock:0})):parseInt(l)>9999&&(n("재고는 9999개를 초과할 수 없습니다","error"),r({...s,stock:9999}))},placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[s.discounts.map((o,l)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx(b,{type:"number",value:o.quantity,onChange:h=>{const d=[...s.discounts];d[l].quantity=parseInt(h.target.value)||0,r({...s,discounts:d})},size:"sm",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx(b,{type:"number",value:o.rate*100,onChange:h=>{const d=[...s.discounts];d[l].rate=(parseInt(h.target.value)||0)/100,r({...s,discounts:d})},size:"xs",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx(C,{variant:"error",type:"button",onClick:()=>{const h=s.discounts.filter((d,g)=>g!==l);r({...s,discounts:h})},icon:e.jsx(P,{})})]},l)),e.jsx(y,{type:"button",onClick:()=>{r({...s,discounts:[...s.discounts,{quantity:10,rate:.1}]})},variant:"link",className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(y,{type:"button",onClick:()=>{c(null),r({name:"",price:0,stock:0,description:"",discounts:[]}),i(!1)},variant:"outline",children:"취소"}),e.jsx(y,{type:"submit",variant:"primary",className:"bg-indigo-600 text-white",children:t==="new"?"추가":"수정"})]})]})})}function je({products:t,isAdmin:s,cart:a,editingProduct:r,productForm:n,handleProductEdit:i,handleProductSubmit:c,onEditClick:o,onFormChange:l,onProductDelete:h,onNotify:d}){const[g,u]=x.useState(!1);return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx(y,{variant:"primary",size:"md",onClick:()=>{o("new"),l({name:"",price:0,stock:0,description:"",discounts:[]}),u(!0)},children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:m.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B(m.price,s,N(m,a)<=0)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.stock>10?"bg-green-100 text-green-800":m.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[m.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:m.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx(y,{variant:"link",onClick:()=>{i(m),u(!0)},className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx(y,{variant:"link",onClick:()=>h(m.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},m.id))})]})}),g&&e.jsx(pe,{editingProduct:r,productForm:n,handleProductSubmit:c,onToggleForm:u,onFormChange:l,onNotify:d,onEditClick:o})]})}function D({children:t,onClick:s,isActive:a}){return e.jsx("button",{onClick:s,className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${a?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:t})}function fe({couponForm:t,onCouponSubmit:s,onCouponFormChange:a,onNotify:r,onToggleForm:n}){return e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx(b,{type:"text",value:t.name,onChange:i=>a({...t,name:i.target.value}),className:"text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx(b,{type:"text",value:t.code,onChange:i=>a({...t,code:i.target.value.toUpperCase()}),className:"text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:t.discountType,onChange:i=>a({...t,discountType:i.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx(b,{type:"text",value:t.discountValue===0?"":t.discountValue,onChange:i=>{const c=i.target.value;(c===""||/^\d+$/.test(c))&&a({...t,discountValue:c===""?0:parseInt(c)})},onBlur:i=>{const c=parseInt(i.target.value)||0;t.discountType==="percentage"?c>100?(r("할인율은 100%를 초과할 수 없습니다","error"),a({...t,discountValue:100})):c<0&&a({...t,discountValue:0}):c>1e5?(r("할인 금액은 100,000원을 초과할 수 없습니다","error"),a({...t,discountValue:1e5})):c<0&&a({...t,discountValue:0})},size:"md",className:"text-sm",placeholder:t.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(y,{type:"button",onClick:()=>n(!1),variant:"outline",children:"취소"}),e.jsx(y,{type:"submit",variant:"primary",className:"bg-indigo-600 text-white",children:"쿠폰 생성"})]})]})})}function ye({coupons:t,couponForm:s,onCouponDelete:a,onCouponSubmit:r,onCouponFormChange:n,onNotify:i}){const[c,o]=x.useState(!1);return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[t.map(l=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:l.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:l.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:l.discountType==="amount"?`${l.discountValue.toLocaleString()}원 할인`:`${l.discountValue}% 할인`})})]}),e.jsx(C,{variant:"danger",onClick:()=>a(l.code),icon:e.jsx(te,{})})]})},l.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs(y,{onClick:()=>o(!c),className:"!text-gray-400 hover:text-gray-600 flex flex-col items-center",variant:"ghost",children:[e.jsx(se,{}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),c&&e.jsx(fe,{couponForm:s,onCouponSubmit:r,onCouponFormChange:n,onNotify:i,onToggleForm:o})]})]})}function be({products:t,isAdmin:s,cart:a,editingProduct:r,productForm:n,coupons:i,couponForm:c,onEditClick:o,onFormChange:l,handleProductEdit:h,onProductDelete:d,handleProductSubmit:g,onCouponDelete:u,onCouponSubmit:m,onCouponFormChange:f,onNotify:p}){const[w,v]=x.useState("products");return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx(D,{isActive:w==="products",onClick:()=>v("products"),children:"상품 관리"}),e.jsx(D,{isActive:w==="coupons",onClick:()=>v("coupons"),children:"쿠폰 관리"})]})}),w==="products"?e.jsx(je,{products:t,isAdmin:s,cart:a,editingProduct:r,productForm:n,handleProductEdit:h,handleProductSubmit:g,onEditClick:o,onFormChange:l,onProductDelete:d,onNotify:p}):e.jsx(ye,{coupons:i,couponForm:c,onCouponDelete:u,onCouponSubmit:m,onCouponFormChange:f,onNotify:p})]})}function ve({product:t,cart:s,isAdmin:a,remainingStock:r,addToCart:n}){return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx(ee,{})}),t.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),t.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...t.discounts.map(i=>i.rate))*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:t.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:B(t.price,a,N(t,s)<=0)}),t.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[t.discounts[0].quantity,"개 이상 구매시 할인 ",t.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[r<=5&&r>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",r,"개 남음"]}),r>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",r,"개"]})]}),e.jsx(y,{variant:"primary",size:"lg",disabled:r<=0,onClick:()=>n(t),className:"w-full",children:r<=0?"품절":"장바구니 담기"})]})]},t.id)}function Ne({item:t,onRemoveFromCart:s,onUpdateQuantity:a,hasDiscount:r,discountRate:n,itemTotal:i}){return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:t.product.name}),e.jsx(C,{variant:"danger",onClick:()=>s(t.product.id),icon:e.jsx(P,{})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{onClick:()=>a(t.product.id,t.quantity-1),size:"xs",variant:"outline",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:t.quantity}),e.jsx(y,{onClick:()=>a(t.product.id,t.quantity+1),size:"xs",variant:"outline",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[r&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",n,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(i).toLocaleString(),"원"]})]})]})]})}function we({totals:t,onCompleteOrder:s}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[t.totalBeforeDiscount.toLocaleString(),"원"]})]}),t.totalBeforeDiscount-t.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",(t.totalBeforeDiscount-t.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[t.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs(y,{onClick:s,size:"lg",className:"w-full hover:bg-yellow-500 bg-yellow-400 !text-gray-900 mt-4 py-3",children:[t.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})}function ke({coupons:t,cart:s,selectedCoupon:a,onApplyCoupon:r,onSelectedCouponChange:n}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx(y,{variant:"link",className:"text-xs",children:"쿠폰 등록"})]}),t.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:a?.code||"",onChange:i=>{const c=t.find(o=>o.code===i.target.value);c?r(c,s):n(null)},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map(i=>e.jsxs("option",{value:i.code,children:[i.name," (",i.discountType==="amount"?`${i.discountValue.toLocaleString()}원`:`${i.discountValue}%`,")"]},i.code))]})]})}function Ce({cart:t,coupons:s,selectedCoupon:a,totals:r,onRemoveFromCart:n,onUpdateQuantity:i,onApplyCoupon:c,onSelectedCouponChange:o,onCompleteOrder:l}){return e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(T,{className:"w-5 h-5 mr-2",strokeWidth:2}),"장바구니"]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"w-16 h-16 text-gray-300 mx-auto mb-4",strokeWidth:1}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:t.map(h=>{const d=$(h,t),g=h.product.price*h.quantity,u=d<g,m=u?Math.round((1-d/g)*100):0;return e.jsx(Ne,{item:h,onRemoveFromCart:n,onUpdateQuantity:i,hasDiscount:u,discountRate:m,itemTotal:d},h.product.id)})})]}),t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ke,{coupons:s,cart:t,selectedCoupon:a,onApplyCoupon:c,onSelectedCouponChange:o}),e.jsx(we,{totals:r,onCompleteOrder:l})]})]})})}function Se({products:t,filteredProductList:s,debouncedQuery:a,cart:r,isAdmin:n,coupons:i,selectedCoupon:c,totals:o,addToCart:l,onRemoveFromCart:h,onUpdateQuantity:d,onApplyCoupon:g,onSelectedCouponChange:u,onCompleteOrder:m}){return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",t.length,"개 상품"]})]}),s.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',a,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s?.map(f=>{const p=N(f,r);return e.jsx(ve,{product:f,cart:r,isAdmin:n,remainingStock:p,addToCart:l},f.id)})})]})}),e.jsx(Ce,{cart:r,coupons:i,selectedCoupon:c,totals:o,onRemoveFromCart:h,onUpdateQuantity:d,onApplyCoupon:g,onSelectedCouponChange:u,onCompleteOrder:m})]})}const Pe=()=>{const{products:t,deleteProduct:s,updateProduct:a,addProduct:r}=ne(),{notifications:n,removeNotificationAtom:i,addNotification:c}=ie(),[o,l]=x.useState(!1),{productForm:h,setProductForm:d,editingProduct:g,setEditingProduct:u,handleProductSubmit:m,handleProductEdit:f}=ce(r,a),{coupons:p,setCoupons:w,selectedCoupon:v,setSelectedCoupon:S,applyCoupon:V}=oe(j=>c(j,"success"),j=>c(j,"error")),{couponForm:O,setCouponForm:z,deleteCoupon:A,handleCouponSubmit:E}=de(p,w,v,S,j=>c(j,"success"),j=>c(j,"error"),j=>c(j,"success")),{cart:k,setCart:R,totalCartItem:W,addToCart:H,removeFromCart:J,updateQuantity:Q}=ue(t,j=>c(j,"success"),j=>c(j,"error")),{query:U,setQuery:_,debouncedQuery:I}=he(),{completeOrder:G}=xe(()=>R([]),()=>S(null),j=>c(j,"success")),K=M(k,v),X=me(t,I);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.length>0&&e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:n.map(j=>e.jsx(re,{type:j.type,message:j.message,onClose:()=>i(j)},j.id))}),e.jsx(ae,{isAdmin:o,setIsAdmin:l,query:U,setQuery:_,cart:k,totalCartItem:W}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:o?e.jsx(be,{products:t,isAdmin:o,cart:k,editingProduct:g,productForm:h,coupons:p,couponForm:O,onEditClick:u,onFormChange:d,handleProductEdit:f,onProductDelete:s,handleProductSubmit:m,onCouponDelete:A,onCouponSubmit:E,onCouponFormChange:z,onNotify:c}):e.jsx(Se,{products:t,filteredProductList:X,debouncedQuery:I,cart:k,isAdmin:o,coupons:p,selectedCoupon:v,totals:K,addToCart:H,onRemoveFromCart:J,onUpdateQuantity:Q,onApplyCoupon:V,onSelectedCouponChange:S,onCompleteOrder:G})})]})};Y.createRoot(document.getElementById("root")).render(e.jsx(Z.StrictMode,{children:e.jsx(Pe,{})}));
